{"id":"F000","file":"prompts/00-prep.md","description":"Delete old hooks system and prepare project structure","depends_on":[],"edge_cases":[],"decisions":["D001","D002","D009"],"code_refs":["code/bash.md#deletion-commands","code/bash.md#file-inspection"],"status":"completed","verification":"ls hooks/handlers/ && ls hooks/viewer/ && test -d hooks/metrics && cat .claude-plugin/hooks.json | jq ."}
{"id":"F001","file":"prompts/01-types-schema-pricing.md","description":"Core type definitions (MetricEntry, TokenUsage, CostBreakdown, PlanEvent)","depends_on":["F000"],"edge_cases":[],"decisions":["D003","D004"],"code_refs":["code/typescript.md#basic-types","code/typescript.md#configuration-types"],"status":"completed","verification":"bun run tsc --noEmit hooks/metrics/types.ts"}
{"id":"F002","file":"prompts/01-types-schema-pricing.md","description":"SQLite schema with indexes","depends_on":["F000"],"edge_cases":[],"decisions":["D003"],"code_refs":["code/sql.md#schema-definition"],"status":"completed","verification":"cat hooks/metrics/schema.sql | sqlite3 :memory:"}
{"id":"F003","file":"prompts/01-types-schema-pricing.md","description":"Model pricing data with tier fallbacks","depends_on":["F000"],"edge_cases":["EC003"],"decisions":[],"code_refs":["code/typescript.md#configuration-types"],"status":"completed","verification":"bun run tsc --noEmit hooks/metrics/pricing.ts"}
{"id":"F004","file":"prompts/02-database.md","description":"Database layer with CRUD operations","depends_on":["F001","F002"],"edge_cases":["EC001","EC004"],"decisions":["D003","D005"],"code_refs":["code/typescript.md#database-classes","code/sql.md#basic-queries","code/sql.md#performance-optimization"],"status":"completed","verification":"bun test hooks/metrics/__tests__/database.test.ts"}
{"id":"F005","file":"prompts/03-event-emitter.md","description":"Event emitter for pub/sub","depends_on":["F000"],"edge_cases":[],"decisions":["D006"],"code_refs":["code/typescript.md#core-classes"],"status":"completed","verification":"bun test hooks/utils/__tests__/event-emitter.test.ts"}
{"id":"F006","file":"prompts/04-config.md","description":"Configuration module","depends_on":["F000"],"edge_cases":[],"decisions":[],"code_refs":["code/typescript.md#configuration-types"],"status":"completed","verification":"bun run tsc --noEmit hooks/metrics/config.ts"}
{"id":"F007","file":"prompts/05-collector.md","description":"MetricsCollector class (central orchestrator)","depends_on":["F001","F004","F005"],"edge_cases":["EC004"],"decisions":["D006"],"code_refs":["code/typescript.md#core-classes"],"status":"completed","verification":"bun test hooks/metrics/__tests__/collector.test.ts"}
{"id":"F008","file":"prompts/06-transcript-parser.md","description":"Transcript parser with fs.watch","depends_on":["F001","F005","F006"],"edge_cases":["EC002","EC006","EC007","EC008"],"decisions":["D007"],"code_refs":["code/typescript.md#parser-logic","code/typescript.md#file-watching"],"status":"completed","verification":"bun test hooks/metrics/__tests__/transcript-parser.test.ts"}
{"id":"F009","file":"prompts/07-cost-calculator.md","description":"Cost calculator (tokens to USD)","depends_on":["F001","F003"],"edge_cases":["EC003"],"decisions":[],"code_refs":["code/typescript.md#calculation-logic"],"status":"completed","verification":"bun test hooks/metrics/__tests__/cost-calculator.test.ts"}
{"id":"F010","file":"prompts/08-plan-events.md","description":"Plan orchestration event capture","depends_on":["F001","F005","F006"],"edge_cases":[],"decisions":["D008"],"code_refs":["code/typescript.md#file-watching"],"status":"completed","verification":"bun test hooks/metrics/__tests__/plan-events.test.ts"}
{"id":"F011","file":"prompts/09-aggregation.md","description":"Time-window aggregation service","depends_on":["F004"],"edge_cases":[],"decisions":["D004"],"code_refs":["code/typescript.md#calculation-logic","code/sql.md#aggregation-queries","code/sql.md#time-window-aggregations"],"status":"completed","verification":"bun test hooks/metrics/__tests__/aggregation-service.test.ts"}
{"id":"F012","file":"prompts/10-session-handlers.md","description":"Session lifecycle handlers (session-start, session-end)","depends_on":["F007"],"edge_cases":[],"decisions":[],"code_refs":["code/typescript.md#hook-handlers"],"status":"completed","verification":"bun run tsc --noEmit hooks/handlers/session-start.ts hooks/handlers/session-end.ts"}
{"id":"F013","file":"prompts/11-user-handlers.md","description":"User interaction handlers (user-prompt-submit, stop)","depends_on":["F007"],"edge_cases":[],"decisions":[],"code_refs":["code/typescript.md#hook-handlers"],"status":"completed","verification":"bun run tsc --noEmit hooks/handlers/user-prompt-submit.ts hooks/handlers/stop.ts"}
{"id":"F014","file":"prompts/12-tool-handlers.md","description":"Tool execution handlers (pre/post-tool-use, post-tool-use-failure)","depends_on":["F007"],"edge_cases":[],"decisions":[],"code_refs":["code/typescript.md#hook-handlers"],"status":"completed","verification":"bun run tsc --noEmit hooks/handlers/pre-tool-use.ts hooks/handlers/post-tool-use.ts hooks/handlers/post-tool-use-failure.ts"}
{"id":"F015","file":"prompts/13-subagent-handlers.md","description":"Subagent lifecycle handlers","depends_on":["F007"],"edge_cases":[],"decisions":[],"code_refs":["code/typescript.md#hook-handlers"],"status":"completed","verification":"bun run tsc --noEmit hooks/handlers/subagent-start.ts hooks/handlers/subagent-stop.ts"}
{"id":"F016","file":"prompts/14-system-handlers.md","description":"System event handlers (notification, pre-compact, permission-request)","depends_on":["F007"],"edge_cases":[],"decisions":[],"code_refs":["code/typescript.md#hook-handlers"],"status":"completed","verification":"bun run tsc --noEmit hooks/handlers/notification.ts hooks/handlers/pre-compact.ts hooks/handlers/permission-request.ts"}
{"id":"F017","file":"prompts/15-viewer-security-config.md","description":"Viewer security utilities","depends_on":["F000"],"edge_cases":["EC005"],"decisions":[],"code_refs":["code/typescript.md#security-utilities"],"status":"completed","verification":"bun run tsc --noEmit hooks/viewer/security.ts"}
{"id":"F018","file":"prompts/15-viewer-security-config.md","description":"Viewer configuration","depends_on":["F006"],"edge_cases":[],"decisions":[],"code_refs":["code/typescript.md#configuration-types"],"status":"completed","verification":"bun run tsc --noEmit hooks/viewer/config.ts"}
{"id":"F019","file":"prompts/16-viewer-server.md","description":"HTTP server base","depends_on":["F017","F018"],"edge_cases":[],"decisions":[],"code_refs":["code/typescript.md#http-server"],"status":"completed","verification":"bun test hooks/viewer/__tests__/server.test.ts"}
{"id":"F020","file":"prompts/17-metrics-api.md","description":"Metrics API endpoints","depends_on":["F019","F007","F011"],"edge_cases":[],"decisions":[],"code_refs":["code/typescript.md#api-handlers"],"status":"completed","verification":"bun test hooks/viewer/__tests__/api/metrics.test.ts"}
{"id":"F021","file":"prompts/18-plans-api.md","description":"Plans API endpoints","depends_on":["F019","F010"],"edge_cases":[],"decisions":[],"code_refs":["code/typescript.md#api-handlers"],"status":"completed","verification":"bun test hooks/viewer/__tests__/api/plans.test.ts"}
{"id":"F022","file":"prompts/19-sessions-api.md","description":"Sessions API endpoints","depends_on":["F019","F007"],"edge_cases":[],"decisions":[],"code_refs":["code/typescript.md#api-handlers"],"status":"completed","verification":"bun test hooks/viewer/__tests__/api/sessions.test.ts"}
{"id":"F023","file":"prompts/20-sse-streaming.md","description":"SSE streaming handlers","depends_on":["F019","F005"],"edge_cases":["EC005"],"decisions":[],"code_refs":["code/typescript.md#sse-handlers"],"status":"completed","verification":"bun test hooks/viewer/__tests__/sse/events.test.ts"}
{"id":"F024","file":"prompts/21-unit-tests.md","description":"Unit tests for core modules","depends_on":["F001","F004","F005","F007","F008","F009","F011"],"edge_cases":[],"decisions":[],"code_refs":["code/typescript.md#testing-patterns"],"status":"completed","verification":"bun test hooks/metrics/__tests__/ && bun test --coverage"}
{"id":"F025","file":"prompts/22-integration-tests.md","description":"Integration tests for data pipeline","depends_on":["F012","F013","F014","F015","F016"],"edge_cases":[],"decisions":[],"code_refs":["code/typescript.md#testing-patterns"],"status":"completed","verification":"bun test hooks/handlers/__tests__/integration.test.ts"}
{"id":"F026","file":"prompts/23-api-tests.md","description":"API endpoint tests","depends_on":["F020","F021","F022","F023"],"edge_cases":[],"decisions":[],"code_refs":["code/typescript.md#testing-patterns"],"status":"completed","verification":"bun test hooks/viewer/__tests__/api/"}
{"id":"F027","file":"prompts/24-handler-tests.md","description":"Hook handler tests","depends_on":["F012","F013","F014","F015","F016"],"edge_cases":[],"decisions":[],"code_refs":["code/typescript.md#testing-patterns"],"status":"completed","verification":"bun test hooks/handlers/__tests__/"}
{"id":"F028","file":"prompts/25-documentation.md","description":"Update CLAUDE.md with new architecture","depends_on":["F024","F025","F026","F027"],"edge_cases":[],"decisions":["D010"],"code_refs":[],"status":"completed","verification":"cat CLAUDE.md"}
