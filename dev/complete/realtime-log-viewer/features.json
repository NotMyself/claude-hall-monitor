{
  "project": "realtime-log-viewer",
  "version": "1.0.0",
  "description": "Real-time log viewer for Claude Code hooks with Vue.js UI",
  "features": [
    {
      "id": "01-types",
      "name": "TypeScript Interfaces",
      "description": "Create type definitions for LogEntry, HookEventType, SSEMessage, FilterState",
      "status": "pending",
      "layer": 1,
      "dependencies": [],
      "file": ".claude/hooks/viewer/types.ts",
      "prompt": "prompts/01-types.md",
      "verification": "cd .claude/hooks && bun run tsc --noEmit viewer/types.ts",
      "acceptance": [
        "LogEntry interface has timestamp, event, session_id, data fields",
        "HookEventType union includes all 12 event types",
        "SSEMessage interface supports entries, entry, heartbeat, error types",
        "FilterState interface has search, eventTypes, sessionId fields",
        "File compiles without TypeScript errors"
      ]
    },
    {
      "id": "02-config",
      "name": "Configuration Module",
      "description": "Create configuration constants for server port, paths, and intervals",
      "status": "pending",
      "layer": 1,
      "dependencies": [],
      "file": ".claude/hooks/viewer/config.ts",
      "prompt": "prompts/02-config.md",
      "verification": "cd .claude/hooks && bun run tsc --noEmit viewer/config.ts",
      "acceptance": [
        "PORT constant set to 3456",
        "LOG_FILE_PATH points to ../hooks-log.txt",
        "SSE_HEARTBEAT_INTERVAL set to 30000ms",
        "Config exports are typed",
        "File compiles without TypeScript errors"
      ]
    },
    {
      "id": "03-watcher",
      "name": "File Watcher Utility",
      "description": "Create LogFileWatcher class to monitor hooks-log.txt for changes",
      "status": "pending",
      "layer": 2,
      "dependencies": ["01-types", "02-config"],
      "file": ".claude/hooks/viewer/watcher.ts",
      "prompt": "prompts/03-watcher.md",
      "verification": "cd .claude/hooks && bun run tsc --noEmit viewer/watcher.ts",
      "acceptance": [
        "LogFileWatcher class implements file watching",
        "Tracks file size to detect new content",
        "Parses JSONL format correctly",
        "Emits new entries via callback",
        "getAllEntries() returns all existing entries",
        "Handles missing log file gracefully"
      ]
    },
    {
      "id": "04-server-basic",
      "name": "Basic HTTP Server",
      "description": "Create Bun HTTP server with static file serving",
      "status": "pending",
      "layer": 2,
      "dependencies": ["02-config"],
      "file": ".claude/hooks/viewer/server.ts",
      "prompt": "prompts/04-server-basic.md",
      "verification": "cd .claude/hooks/viewer && timeout 3 bun run server.ts || true",
      "acceptance": [
        "Server starts on port 3456",
        "GET / returns index.html",
        "GET /styles/* serves CSS files",
        "404 for unknown routes",
        "Graceful shutdown on SIGINT"
      ]
    },
    {
      "id": "05-server-sse",
      "name": "SSE Endpoint",
      "description": "Add Server-Sent Events endpoint for real-time updates",
      "status": "pending",
      "layer": 3,
      "dependencies": ["04-server-basic", "03-watcher"],
      "file": ".claude/hooks/viewer/server.ts",
      "prompt": "prompts/05-server-sse.md",
      "verification": "cd .claude/hooks/viewer && timeout 3 bun run server.ts || true",
      "acceptance": [
        "GET /events returns SSE stream",
        "Content-Type is text/event-stream",
        "Sends initial entries on connect",
        "Streams new entries as they arrive",
        "Heartbeat every 30 seconds",
        "Handles client disconnect"
      ]
    },
    {
      "id": "06-server-api",
      "name": "REST API Endpoint",
      "description": "Add JSON API endpoint for fetching all entries",
      "status": "pending",
      "layer": 3,
      "dependencies": ["05-server-sse"],
      "file": ".claude/hooks/viewer/server.ts",
      "prompt": "prompts/06-server-api.md",
      "verification": "cd .claude/hooks/viewer && timeout 3 bun run server.ts || true",
      "acceptance": [
        "GET /api/entries returns JSON array",
        "Content-Type is application/json",
        "Returns all log entries",
        "Handles empty log file"
      ]
    },
    {
      "id": "07-theme-css",
      "name": "Theme CSS",
      "description": "Create Claude Code Docs-inspired theme with light/dark modes",
      "status": "pending",
      "layer": 4,
      "dependencies": [],
      "file": ".claude/hooks/viewer/styles/theme.css",
      "prompt": "prompts/07-theme-css.md",
      "verification": "test -f .claude/hooks/viewer/styles/theme.css",
      "acceptance": [
        "CSS variables for light mode colors",
        "CSS variables for dark mode colors",
        "Primary terracotta color #D4A27F",
        "Poppins font family",
        "12 distinct badge colors for event types",
        "Card styling with 12px border-radius",
        "Responsive layout styles"
      ]
    },
    {
      "id": "08-html-skeleton",
      "name": "HTML Skeleton",
      "description": "Create base HTML structure with Vue 3 CDN setup",
      "status": "pending",
      "layer": 5,
      "dependencies": ["07-theme-css"],
      "file": ".claude/hooks/viewer/index.html",
      "prompt": "prompts/08-html-skeleton.md",
      "verification": "test -f .claude/hooks/viewer/index.html",
      "acceptance": [
        "Valid HTML5 document",
        "Vue 3 loaded from CDN",
        "Poppins font from Google Fonts",
        "Theme CSS linked",
        "App mount point div#app",
        "Basic Vue app initialization"
      ]
    },
    {
      "id": "09-eventbadge",
      "name": "EventBadge Component",
      "description": "Create Vue component for colored event type badges",
      "status": "pending",
      "layer": 5,
      "dependencies": ["08-html-skeleton"],
      "file": ".claude/hooks/viewer/index.html",
      "prompt": "prompts/09-eventbadge.md",
      "verification": "grep -q 'event-badge' .claude/hooks/viewer/index.html",
      "acceptance": [
        "Component accepts event prop",
        "Displays event name as text",
        "Applies correct color class based on event type",
        "Uses CSS classes from theme.css",
        "Compact badge styling"
      ]
    },
    {
      "id": "10-themetoggle",
      "name": "ThemeToggle Component",
      "description": "Create Vue component to toggle between light/dark/system themes",
      "status": "pending",
      "layer": 5,
      "dependencies": ["09-eventbadge"],
      "file": ".claude/hooks/viewer/index.html",
      "prompt": "prompts/10-themetoggle.md",
      "verification": "grep -q 'theme-toggle' .claude/hooks/viewer/index.html",
      "acceptance": [
        "Cycles through light/dark/system on click",
        "Persists preference to localStorage",
        "Respects system preference when set to system",
        "Updates document class for theme",
        "Shows current theme icon"
      ]
    },
    {
      "id": "11-filterbar",
      "name": "FilterBar Component",
      "description": "Create Vue component with search, event filter, and session select",
      "status": "pending",
      "layer": 5,
      "dependencies": ["10-themetoggle"],
      "file": ".claude/hooks/viewer/index.html",
      "prompt": "prompts/11-filterbar.md",
      "verification": "grep -q 'filter-bar' .claude/hooks/viewer/index.html",
      "acceptance": [
        "Search input with debounce",
        "Event type multi-select dropdown",
        "Session ID select dropdown",
        "Clear filters button",
        "Emits filter change events",
        "Populates session list from entries"
      ]
    },
    {
      "id": "12-logentry",
      "name": "LogEntry Component",
      "description": "Create Vue component for expandable log entry cards",
      "status": "pending",
      "layer": 5,
      "dependencies": ["11-filterbar"],
      "file": ".claude/hooks/viewer/index.html",
      "prompt": "prompts/12-logentry.md",
      "verification": "grep -q 'log-entry' .claude/hooks/viewer/index.html",
      "acceptance": [
        "Displays timestamp, event badge, session ID",
        "Expandable to show JSON data",
        "Copy to clipboard button",
        "Pretty-printed JSON view",
        "Click to expand/collapse",
        "Visual indication of expanded state"
      ]
    },
    {
      "id": "13-logviewer",
      "name": "LogViewer Component",
      "description": "Create Vue component for filtered, scrollable log list",
      "status": "pending",
      "layer": 5,
      "dependencies": ["12-logentry"],
      "file": ".claude/hooks/viewer/index.html",
      "prompt": "prompts/13-logviewer.md",
      "verification": "grep -q 'log-viewer' .claude/hooks/viewer/index.html",
      "acceptance": [
        "Renders list of LogEntry components",
        "Applies filters from FilterBar",
        "Auto-scrolls to new entries",
        "Shows entry count",
        "Handles empty state",
        "Virtualized for performance with large lists"
      ]
    },
    {
      "id": "14-tabcontainer",
      "name": "TabContainer Component",
      "description": "Create Vue component for tab-based navigation",
      "status": "pending",
      "layer": 5,
      "dependencies": ["13-logviewer"],
      "file": ".claude/hooks/viewer/index.html",
      "prompt": "prompts/14-tabcontainer.md",
      "verification": "grep -q 'tab-container' .claude/hooks/viewer/index.html",
      "acceptance": [
        "Tab navigation bar",
        "Event Log tab active by default",
        "Extensible for future tabs",
        "Tab content slot",
        "Active tab styling"
      ]
    },
    {
      "id": "15-sse-client",
      "name": "SSE Client Connection",
      "description": "Implement client-side SSE connection with auto-reconnect",
      "status": "pending",
      "layer": 6,
      "dependencies": ["14-tabcontainer"],
      "file": ".claude/hooks/viewer/index.html",
      "prompt": "prompts/15-sse-client.md",
      "verification": "grep -q 'EventSource' .claude/hooks/viewer/index.html",
      "acceptance": [
        "Connects to /events endpoint",
        "Handles initial entries message",
        "Handles new entry messages",
        "Auto-reconnects on disconnect",
        "Connection status indicator",
        "Exponential backoff on reconnect"
      ]
    },
    {
      "id": "16-app-integration",
      "name": "App Integration",
      "description": "Wire all components together in main Vue app",
      "status": "pending",
      "layer": 6,
      "dependencies": ["15-sse-client"],
      "file": ".claude/hooks/viewer/index.html",
      "prompt": "prompts/16-app-integration.md",
      "verification": "cd .claude/hooks/viewer && timeout 5 bun run server.ts &; sleep 2; curl -s http://localhost:3456/ | grep -q 'vue'; kill %1 2>/dev/null || true",
      "acceptance": [
        "All components registered",
        "State management working",
        "Filter state flows correctly",
        "New entries appear in real-time",
        "Theme toggle works",
        "Footer shows connection status and entry count"
      ]
    },
    {
      "id": "17-test-setup",
      "name": "Test Configuration",
      "description": "Configure Vitest with happy-dom for component testing",
      "status": "pending",
      "layer": 7,
      "dependencies": ["16-app-integration"],
      "file": ".claude/hooks/viewer/vitest.config.ts",
      "prompt": "prompts/17-test-setup.md",
      "verification": "test -f .claude/hooks/viewer/vitest.config.ts",
      "acceptance": [
        "Vitest configured with happy-dom",
        "Setup file for mocks created",
        "localStorage mock",
        "matchMedia mock",
        "navigator.clipboard mock",
        "Test script in package.json"
      ]
    },
    {
      "id": "18-test-components",
      "name": "Component Tests",
      "description": "Write unit tests for Vue components",
      "status": "pending",
      "layer": 7,
      "dependencies": ["17-test-setup"],
      "file": ".claude/hooks/viewer/__tests__/components.test.ts",
      "prompt": "prompts/18-test-components.md",
      "verification": "cd .claude/hooks && bun test viewer/__tests__/components.test.ts",
      "acceptance": [
        "EventBadge renders correct color",
        "ThemeToggle cycles themes",
        "FilterBar emits filter events",
        "LogEntry expands/collapses",
        "All tests pass"
      ]
    },
    {
      "id": "19-test-server",
      "name": "Server Tests",
      "description": "Write tests for HTTP server and SSE endpoint",
      "status": "pending",
      "layer": 7,
      "dependencies": ["18-test-components"],
      "file": ".claude/hooks/viewer/__tests__/server.test.ts",
      "prompt": "prompts/19-test-server.md",
      "verification": "cd .claude/hooks && bun test viewer/__tests__/server.test.ts",
      "acceptance": [
        "GET / returns HTML",
        "GET /events returns SSE stream",
        "GET /api/entries returns JSON",
        "404 for unknown routes",
        "All tests pass"
      ]
    },
    {
      "id": "20-session-start",
      "name": "Session Start Integration",
      "description": "Modify session-start.ts to auto-start viewer and print link",
      "status": "pending",
      "layer": 8,
      "dependencies": ["19-test-server"],
      "file": ".claude/hooks/session-start.ts",
      "prompt": "prompts/20-session-start.md",
      "verification": "cd .claude/hooks && bun run tsc --noEmit session-start.ts",
      "acceptance": [
        "isViewerRunning() checks if server is up",
        "startViewerServer() spawns detached process",
        "On startup source, checks and starts viewer",
        "Prints clickable link to stderr",
        "Includes viewer URL in additionalContext",
        "Does not break existing functionality"
      ]
    },
    {
      "id": "21-package-json",
      "name": "Package.json Updates",
      "description": "Add scripts and dependencies for viewer and testing",
      "status": "pending",
      "layer": 8,
      "dependencies": ["20-session-start"],
      "file": ".claude/hooks/package.json",
      "prompt": "prompts/21-package-json.md",
      "verification": "cd .claude/hooks && bun install",
      "acceptance": [
        "viewer script added",
        "viewer:dev script added",
        "test script added",
        "test:coverage script added",
        "vitest devDependency added",
        "@vue/test-utils devDependency added",
        "happy-dom devDependency added",
        "bun install succeeds"
      ]
    },
    {
      "id": "22-final-validation",
      "name": "End-to-End Validation",
      "description": "Verify complete system works together",
      "status": "pending",
      "layer": 9,
      "dependencies": ["21-package-json"],
      "file": null,
      "prompt": "prompts/22-final-validation.md",
      "verification": "cd .claude/hooks && bun test",
      "acceptance": [
        "Server starts successfully",
        "UI loads in browser",
        "SSE connection established",
        "New log entries appear in real-time",
        "Filters work correctly",
        "Theme toggle works",
        "All tests pass",
        "TypeScript compiles without errors"
      ]
    }
  ]
}
